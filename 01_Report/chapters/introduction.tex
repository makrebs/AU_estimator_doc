\chapter{Introduction}
\label{chap:introduction}

\section{Motivation}
Blimps are ideal vehicles for being used as aerial advertising medium. Especially eye-catching are specifically shaped blimps, e.g. blimps that have the shape of a mascot, car or any other commercial product (see figure \ref{fig:blimps}).
As an alternative, conventionally shaped blimps can show imprints or banners.
The arrangement of the actuators for those different shaped blimps varies a lot.
In general, manual adjustment of the control algorithms is needed or the actuators have to be controlled manually at all.
Using some adequate sensors, it would be useful to determine the effect of an actuator on the movement of the blimp automatically.
When such an algorithm is available, the blimp hull can be manufactured independently on the actuation which just can be attached to the blimp and the controller figures out the effect of its actuators by its own.
This is illustrated by \cref{fig:motivation}.

\begin{figure}[hbtp]
\centering
\includegraphics[width=.4\linewidth]{images/CustomBull_Lg.jpg}
\includegraphics[width=.4\linewidth]{images/CustomCar.jpg}
\caption{Special shaped blimps are used for advertising \citep{rcblimps}.}
\label{fig:blimps}
\end{figure}

\begin{figure}[hbtp]
\centering
\includegraphics[width=.85\linewidth]{images/motivation.png}
\caption{The goal is to find an algorithm, that allow to take any blimp shape (\textit{left}) and put the actuation units (\textit{center}) on. The actuation configuration is then automatically detected, such that elegant movements can be performed without manual controller adjustments (\textit{right}).}
\label{fig:motivation}
\end{figure}

\section{Configuration Estimation}
This work is on estimation of the actuation configuration for a multi-actuated blimp.
It is motivated on our work on Skye, a spherical and omnidirectional blimp.
Its design and control is described in detail in \citep{Skye2013} and briefly summarized below. \\
Various work on thruster configuration estimation can be found for underwater robot systems.
\Citet{Doniec} propose black box model approach.
They calculate an inverse model of the thrusters, i.e. a mapping from a desired rotation and position change of the robot to the thruster commands. After about 40 seconds of random walk, the inverse model is computed as the Moore-Penrose pseudoinverse of the collected input/output data.
\Citet{VandeVen2005} show an overview of neural network control of underwater vehicles. \\ 
If a first principle based model of the system is available, gray box modelling may be applied.
Many aerospace and robotics tasks are solved using physical meaningful models.
To determine the sensor alignments after launch shock, \citet{Shuster1991} estimate the rotation vector between multiple star tracker devices using batch optimization.
\Citet{Bloesch2013} formulated a nonlinear least squares problem to estimate kinematic parameters of a legged robot.
In depth studies using batch optimization have been made for intrinsic and extrinsic (stereo) camera calibration \citep[see]{Siegwart}.
In recent time, visual-inertia sensor calibration has found much attraction.
Beside others, \citet{Hol2011} shows both batch and recursive estimation (Kalman Filter) for this task.

\section{Skye System Overview}
The practical part of this work is done with the Skye System \citep{Skye2013}.\\
Skye is a spherical blimp (\cref{fig:frames}, right) where the center of gravity coincides with the center of buoyancy.
Four identical actuators (\cref{fig:frames}, left) are attached to the hull of Skye in a tetrahedral arrangement.
Each of these actuators can rotate around their z-axis.
Mounted to the rotating part of the actuators there is an impeller which can generate thrust.
% in the XY-plane along the direction it is currently pointed.
This setup gives Skye the ability to move and rotate in all directions with more or less the same efficiency \citep[see][chap. 3]{Schaffner2012}.

\subsection{Coordinate Systems}
In this work we use different coordinate systems to represent the blimp states and the actuation properties.
\begin{description}
\item[The world frame ($w$-frame] is a stationary frame in which the blimp is moving around.
\item[The blimp frame ($b$-frame)] (see \cref{fig:frames}, right) is defined according to the onboard camera as a NED coordinate system. 
When the camera is upright and pointing forward, the blimp coordinate system has the x-direction pointing into the direction of the camera and the z-direction pointing downwards.
Its origin coincides with the center of the ideal spherical blimp.
\item[The motor frames ($m^k$-frame)] (see \cref{fig:frames}, left) are aligned to each actuator units $k=1,...,N$.
When the actuator is standing on a horizontal surface, the z-axis is defined to point downwards.
The coordinate system origin is set to the base of the actuator such that the z-axis coincides with the rotation axe of the actuator.
The x-axis is defined to be pointing in the direction of the thruster when its orientation angle $\alpha^k$ (see \cref{fig:motor_force}).
%To put it another way, the thrust-force points in the x-axis direction when the actuator angle is zero.
\end{description}

The force vector $\mathbf{F_{m^k}^k}$ generated by the actuation unit $k$ is therefore
\begin{equation}
\mathbf{F_{m^k}^k} = 
\left[\begin{array}{c}
F^k \cos(\alpha^k) \\
F^k \sin(\alpha^k) \\
0
\end{array}\right]
\end{equation}
where $F^k$ is the thrust force magnitude.

\begin{figure}[hbtp]
\centering
\includegraphics[width=.4\linewidth]{images/motor_frame.eps}
\includegraphics[width=.4\linewidth]{images/blimp_frame.eps}
\caption{\textbf{Left}: Motor coordinate frame $m^k$. When the thruster is not rotated, it directs in $\mathbf{e}^x_{m^k}$ direction. $\mathbf{e}^z_{m^k}$ directs to the bottom. \textbf{Right}: Blimp coordinate frame $b$. $\mathbf{e}^x_{b}$ directs to the camera which is mounted at the front. $\mathbf{e}^z_{b}$ directs to the bottom.}
\label{fig:frames}
\end{figure}


\begin{figure}[hbtp]
\centering
\includegraphics[width=.4\linewidth]{images/motor_force.eps}
\caption{BLAAAAAAAAAAAAAAA}
\label{fig:motor_force}
\end{figure}

\subsection{Hardware and Software}
Skye is based around the Inertial Measurement Unit from the PIXHAWK Research Project (??ref??). 
The firmware of Skye is based on the PX4 autopilot project (??ref??) and augmented with Skye specific features.
To control Skye a QGroundControl (??ref??) based interface is installed on a Laptop which is connected via a XBEE link to the PX4 autopilot.
From there user input is provided with a 3D mouse from 3Dconnexion.

\subsection{Sensors}
Onboard the PX4 autopilot are the sensors used in this work.
While the PX4 autopilot has many sensors the most important sensor for this work is the MPU-6000 Six-Axis (Gyro + Accelerometer) MEMS MotionTrackingâ„¢ Device.
This sensor measures angular velocities around all three axes of rotation as well as translational acceleration in all three directions. \\
As will be explained later we use mainly the gyro sensor. To get an understanding of the performance of this sensor we measured the noise of the sensor to be about $3.2 \cdot 10^{-4}rad/s$ RMS.

\subsection{Allocation}

\begin{figure}[hbtp]
\centering
\includegraphics[width=.9\linewidth]{images/system_loop_3.eps}
\caption{Skye control loop.}
\label{fig:system_loop_3}
\end{figure}

The unique thing about Skye is the way controlled flight is achieved. 
\Cref{fig:system_loop_3} shows the control loop of Skye.
Because the actuators of Skye have 8DOF and the flying body has only 6DOF of control, the mapping between the controller output and the actuator inputs is not a unique mapping. (??cite vue??)
This mapping is solved with lagrange with the cost-function set to optimize power consumption of the actuators. See (??ref??) for more details.\\
For this work, the important part about the allocation is that it is derived from the positions and orientations of the motors.

